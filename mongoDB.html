<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
    <meta name="google-site-verification" content="VXixwtxrf--qUV1swfStEg9jOGPKgUm6C3Ub_vouqmc" />
    <title>MecBar | The Mec Evolution </title>
    <link rel="icon" href="foto/favicon.ico"/>
    <!-- CSS  -->
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
   -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="https://fonts.googleapis.com/css?family=Raleway|Satisfy" rel="stylesheet">
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script> 
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->

    <meta property="og:url" content="https://www.mecbar.com" />
    <meta property="og:title" content="MecBar the webt for you" />
    <meta property="og:image" content="https://www.mecbar.com/mecface.jpg" />
    <meta property="og:description" content="MecBar for you" />


</head>

<body>
    
    <nav>
        <li class="nav-wrapper back-home" id="head">
            <a href="http://www.mecbar.com/" class="aabrand-logo mecbar">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg
                   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                   xmlns:cc="http://creativecommons.org/ns#"
                   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                   xmlns:svg="http://www.w3.org/2000/svg"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   width="156"
                   height="64"
                   viewBox="0 0 12.3825 5.08"
                   version="1.1"
                   id="svg8"
                   inkscape:version="1.0 (6e3e5246a0, 2020-05-07)"
                   sodipodi:docname="mecbar.svg">
                  <defs
                     id="defs2">
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient2948">
                      <stop
                         id="stop2946"
                         offset="0"
                         style="stop-color:#c6126a;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient875">
                      <stop
                         id="stop873"
                         offset="0"
                         style="stop-color:#babd06;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3253"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#878734;stop-opacity:1;"
                         offset="0"
                         id="stop3251" />
                    </linearGradient>
                    <linearGradient
                       inkscape:collect="always"
                       id="linearGradient3093">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3089" />
                      <stop
                         style="stop-color:#c6126a;stop-opacity:0;"
                         offset="1"
                         id="stop3091" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3071"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3069" />
                    </linearGradient>
                    <rect
                       x="38.182308"
                       y="80.104469"
                       width="51.135052"
                       height="30.274338"
                       id="rect18630" />
                    <rect
                       x="160.31746"
                       y="77.487633"
                       width="134.35785"
                       height="60.829021"
                       id="rect18624" />
                    <rect
                       x="70.354279"
                       y="28.223705"
                       width="103.27115"
                       height="64.638908"
                       id="rect18618" />
                    <rect
                       x="32.55666"
                       y="25.199898"
                       width="5.2916665"
                       height="43.089287"
                       id="rect18612" />
                    <rect
                       x="34.029621"
                       y="65.792862"
                       width="93.441322"
                       height="26.673161"
                       id="rect18606" />
                    <rect
                       x="10.284417"
                       y="19.486744"
                       width="193.27823"
                       height="129.88597"
                       id="rect18596" />
                    <linearGradient
                       inkscape:collect="always"
                       xlink:href="#linearGradient3093"
                       id="linearGradient3101"
                       gradientUnits="userSpaceOnUse"
                       x1="3.1346149"
                       y1="23.792595"
                       x2="78.606865"
                       y2="23.792595" />
                    <filter
                       height="1"
                       y="-2.5183475e-16"
                       width="1"
                       x="-7.1910066e-17"
                       style="color-interpolation-filters:sRGB"
                       inkscape:label="Blend"
                       id="filter3198">
                      <feBlend
                         in2="SourceGraphic"
                         mode="multiply"
                         result="fbSourceGraphic"
                         id="feBlend3196" />
                      <feColorMatrix
                         result="fbSourceGraphicAlpha"
                         in="fbSourceGraphic"
                         values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0"
                         id="feColorMatrix3200" />
                      <feBlend
                         in2="fbSourceGraphic"
                         id="feBlend3202"
                         mode="multiply"
                         result="blend"
                         in="fbSourceGraphic" />
                      <feGaussianBlur
                         id="feGaussianBlur869"
                         stdDeviation="6.7542215e-15" />
                    </filter>
                    <linearGradient
                       gradientUnits="userSpaceOnUse"
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       id="linearGradient2950"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                    <linearGradient
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       gradientTransform="translate(2.3455617,-9.683066)"
                       gradientUnits="userSpaceOnUse"
                       id="linearGradient3064"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                  </defs>
                  <sodipodi:namedview
                     id="base"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:pageopacity="0.0"
                     inkscape:pageshadow="2"
                     inkscape:zoom="0.7"
                     inkscape:cx="355.19772"
                     inkscape:cy="45.714286"
                     inkscape:document-units="mm"
                     inkscape:current-layer="layer1-6"
                     inkscape:document-rotation="0"
                     showgrid="false"
                     inkscape:window-width="1324"
                     inkscape:window-height="747"
                     inkscape:window-x="36"
                     inkscape:window-y="21"
                     inkscape:window-maximized="1"
                     units="px"
                     inkscape:snap-nodes="true"
                     inkscape:object-paths="true"
                     scale-x="0.3" />
                  <metadata
                     id="metadata5">
                    <rdf:RDF>
                      <cc:Work
                         rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type
                           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                      </cc:Work>
                    </rdf:RDF>
                  </metadata>
                  <g
                     inkscape:label="Layer 1"
                     inkscape:groupmode="layer"
                     class="io"
                     id="layer1">
                    <rect
                       ry="7.1295023"
                       rx="10.726023"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="21.245117"
                       width="20.103241"
                       id="rect2824"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                    <g
                       inkscape:label="Layer 1"
                       id="layer1-6"
                       transform="matrix(0.16152221,0.0020121,0,0.13626925,0.08059628,0.86541284)"
                       style="mix-blend-mode:normal;fill:url(#linearGradient2950);fill-opacity:1;stroke-width:6.74038;filter:url(#filter3198);image-rendering:optimizeQuality">
                      <text
                         xml:space="preserve"
                         id="text18594"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18596);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;line-height:125%;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0px;word-spacing:0px;fill:url(#linearGradient3064);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                         x="-4.0898471"
                         y="24.876211"
                         id="text18602"
                         transform="matrix(0.75566848,-0.20637119,0.34609071,1.2288151,0,0)"><tspan
                   sodipodi:role="line"
                   id="tspan18600"
                   x="-4.0898471"
                   y="24.876211"
                   style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:url(#linearGradient3064);fill-opacity:1;stroke-width:1.78339px">MecBar</tspan>        <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="0s;light_2.end"
                   dur="1s"
                   values="1;0"
                   attributeName="fill-opacity"
                   id="light_1" />       <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="light_1.end"
                   dur="1s"
                   values="0;1"
                   attributeName="fill-opacity"
                   id="light_2" />           </text>
                      <text
                         xml:space="preserve"
                         id="text18604"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18606);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18610"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18612);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18616"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18618);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18622"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18624);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18628"
                         style="font-style:normal;font-weight:normal;font-size:12.7px;line-height:125%;font-family:sans-serif;text-align:justify;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18630);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="0s;light_2.end"
                         dur="1s"
                         values="1;0"
                         attributeName="fill-opacity"
                         id="light_1" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="light_1.end"
                         dur="1s"
                         values="0;1"
                         attributeName="fill-opacity"
                         id="light_2" />
                    </g>
                    <rect
                       ry="7.1295042"
                       rx="10.726021"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="16.413473"
                       width="25.987757"
                       id="rect871"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                  </g>
                  <style
                     id="style43">
                           #tspan18600 {
                               
                              animation-name: mecOpacity;
                              animation-duration: 2s;
                              animation-iteration-count: infinite;
                              }
                              @keyframes mecOpacity {
                              0%   { fill-opacity:1 }
                                50%  {fill-opacity :0.1; }
                            100% { fill-opacity: 1; }
                              }
                        </style>
                </svg>
             
              </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
              <li><a href="http://www.mecbar.com/#block3">Blockchain</a></li>
                <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
                <li><a href="http://www.mecbar.com/#ml">Machine Learning</a></li>
                <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
                <li><a href="http://www.mecbar.com/#Adev">Develop</a></li>
                <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
                <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
                <li>
                    <a href=""> </a>
                </li>
                <li>
                    <a href=""> </a>
                </li>
            </ul>
            <ul class="side-nav" id="mobile-demo">
               <li><a href="http://www.mecbar.com/#block3">Blockchain</a></li>
               <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
               <li><a href="http://www.mecbar.com/#ml">Machine Learning</a></li>
               <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
               <li><a href="http://www.mecbar.com/#Adev">Develop</a></li>
               <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
               <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
            </ul>
            </li>
    </nav>
<style>
    body {
       /* background :linear-gradient(155deg, rgba(203, 252, 207, 0.959 ) 40% , rgba(189, 199, 190, 0.959) 100%);
       */
       font-size: 20px;
        background-color: #e7f6ed;
        line-height:30px;
    }
    .mongobox {
        background-color: #fff;
        border : 2px solid #13aa52;
        color:blue;
        width: 75%;
        height: auto;
        margin-left: 10%;
        margin-right: 10%;
  width:80%;
  padding: 3%;
  margin-top:50px;
  margin-bottom:50px;
    }

    table {
        margin-left: 10%;
        margin-right: 10%;
  width:80%;
  padding: 3%;
}
table, th, td {
  border: 1px solid rgb(168, 24, 24);
  border-collapse: collapse;
  font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
}
th, td {
  padding: 15px;
  text-align: left;
}
.testo {
    margin-left: 10%;
    margin-right: 10%;
    width:80%;
    padding: 3%;
}
</style>
  <div class="titolo">MongoDB </div>
  <div class="testo">
  MongoDB è in database noSQL cioè non Relazionale. Le principali caratteristiche di MongoDB sono:
    - scalabilità <br>
    - è orientato ai documenti <br>
    - codifica json/bson<br>
    - schemaless <br>
    - poliformismo  oggetti simili con attributi diversi <br>
    - auto-sharding  Il db viene in bilanciato automaticamente su diversi server <br>
    <br>
    Anche la terminologia usata è diversa per indicare che la struttura è diversa cerchiamo <br>
    comunque di fare una comparazione tra db relazionale e Mongodb.<br>
 
    <br>
  </div>
    <table>
        <tr>
          <th>RDBMS </th>
          <th> MONGODB </th> 
        </tr>
        <tr>
          <td>db</td>
          <td>db</td>
        </tr>
        <tr>
          <td>table</td>
          <td>collection</td>
        </tr>
        <tr>
          <td>row</td>
          <td>document</td>
        </tr>
        <tr>
          <td>index </td>
          <td> index  </td>
        </tr>
        <tr>
            <td>Join </td>
            <td> Embedded Document  </td>
          </tr>
          <tr>
            <td>Foreign Key </td>
            <td> Reference  </td>
          </tr>
      </table>
      <br>
      <div class="testo">
          Come ogni altro database sono presenti le operazioni CRUD(create, read, update, delete) che qui alcune vengono definite 
          con una propria denominazione per cui vediamo nella tabella sottostante un raffronto tra le diverse terminologie.
      </div>

      <table>
        <tr>
          <th>CRUD </th>
          <th> MONGODB </th> 
        </tr>
        <tr>
          <td>CREATE  </td>
          <td> INSERT</td>
        </tr>
        <tr>
          <td>READ</td>
          <td> FIND</td>
        </tr>
        <tr>
          <td>UPDATE</td>
          <td>UPDATE</td>
        </tr>
        <tr>
          <td>DELETE </td>
          <td> DELETE  </td>
        </tr>
      </table>
      <br>





      <div class="testo">
 MongoDB può essere utilizzato in Cloud oppure installato in locale. Qui faremo degli 
 esempi in locale dalla CLI. 
      </div>

 <table>
    <tr>
      <th>COMANDO MONGODB </th>
      <th> Descrizione</th> 
    </tr>
    <tr>
        <td> show dbs </td>
        <td>Lista dei databases</td>
      </tr>
    <tr>
      <td>db</td>
      <td> database utilizzato   </td>
    </tr>
    <tr>
      <td> use name_db </td>
      <td>Seleziona db da usare</td>
    </tr>
    <tr>
        <td>show collections </td>
        <td> lista collezioni in un database </td>
    </tr>
    <tr>
      <td>db.nome_collection.find() </td>
      <td> senza parametri ritorna tutti i documenti della collection  </td>
    </tr>
    <tr>
      <td>db.nome_collection.find({"key":"value"}).pretty() </td>
      <td> cerca dati nella collection in base al parametro inserito - pretty per aspetto   </td>
    </tr>
    <tr>
      <td>db.nome_collection.findOne() </td>
      <td>la ricerca fornisce un solo risultato </td>
    </tr>
    <tr>
        <td>db.nome_collection.insert()  </td>
        <td> inserimento documento all'interno di una collection </td>
      </tr>
      <tr>
        <td> db.nome_collection.update() </td>
        <td>update documenti </td>
      </tr>    
        <tr>
         <td> db.nome_collection.remove() </td>
         <td> delete i documenti selezionati </td>
       </tr>
       <tr>
         <td> db.nome_collection.drop() </td>
         <td> delete intera collection</td>
       </tr>
       <tr>
         <td>db.dropDatabase() </td>
         <td> delete db </td>
       </tr>
  </table>
  <div class="testo">
  
 Nella CLI digitare mongo per entrare nella console.<br> 
 La console è una interfaccia Javascript per cui possiamo usare tutti gli strumenti 
 di js come ad esempio definire delle var o delle function o inserire direttamente i 
 comandi per operare nei database.<br> 
 Nel riquadro sottostante procediamo ad indicare prima quale db usare con il comando use poi 
 facciamo inserimento di dati in una collection. Da notare che non c'è bisogno di definire una nuova 
 collection perchè mongo quando viene usato il metodo insert definisce la collection che poi può 
 essere usata regolarmente.
Dopo aver inserito diversi documenti all'interno della collection argomenti con il comando show vediamo 
quante collections sono presenti nel db e poi inseriamo un nuovo documento all'interno di una nuova collection 
e con il comando show ricontrolliamo quali collection sono all'interno del db e vediamo la variazione.
  </div>
   <div class="mongobox">

> use mecbar<br>
switched to db mecbar<br>
> db.argomenti.insert( { item: "quantum", settore: "algebra" } );<br>
WriteResult({ "nInserted" : 1 })<br>
> db.argomenti.insert( { item: "quantum", settore: "gate" } );<br>
WriteResult({ "nInserted" : 1 })<br>
> db.argomenti.insert( { item: "blockchain", settore: "ethereum" } );<br>
WriteResult({ "nInserted" : 1 })<br>
> db.argomenti.insert( { item: "blockchain", settore: "smart contract" } );<br>
WriteResult({ "nInserted" : 1 })<br>
<br>
> show collections<br>
argomenti<br>
> <br><br>
> db.siti.insert( { nome: "mecbar", link: "www.mecbar.com" } );<br>
WriteResult({ "nInserted" : 1 })<br>
> show collections<br>
argomenti<br>
siti<br>
</div>
<div class="testo">

    Dopo avere popolato la collection con diversi documenti possiamo passare ad analizzare il comando per effettuare le ricerche 
    prima senza parametri con find() che ci ritorna tutti i documenti e findOne() che ci ritorna un solo 
    documento. Poi vediamo la ricerca con i parametri da notare che i parametri di ricerca vanno inseriti come un oggetto con 
    le parentesi graffe. 


</div>
<div class="mongobox">
> db.argomenti.find()<br>
{ "_id" : ObjectId("5f3c362808f4769b4fc3aad9"), "item" : "quantum", "settore" : "algebra" }<br>
{ "_id" : ObjectId("5f3c363208f4769b4fc3aada"), "item" : "quantum", "settore" : "gate" }<br>
{ "_id" : ObjectId("5f3c367a08f4769b4fc3aadb"), "item" : "blockchain", "settore" : "ethereum" }<br>
{ "_id" : ObjectId("5f3c36a908f4769b4fc3aadc"), "item" : "blockchain", "settore" : "smart contract" }<br>
> db.argomenti.findOne()<br><br>
{<br>
	"_id" : ObjectId("5f3c362808f4769b4fc3aad9"),<br>
	"item" : "quantum",<br>
	"settore" : "algebra"<br>
}<br><br>
> db.argomenti.find({settore:"ethereum"})<br>
{ "_id" : ObjectId("5f3c367a08f4769b4fc3aadb"), "item" : "blockchain", "settore" : "ethereum" }<br>
> <br>
<br>
> db.argomenti.find({settore:"ethereum"}).pretty()<br><br>
{<br>
	"_id" : ObjectId("5f3c367a08f4769b4fc3aadb"),<br>
	"item" : "blockchain",<br>
	"settore" : "ethereum"<br>
}<br>
</div>

<div class="testo">
Passiamo ora ad analizzare la procedura da seguire per eliminare un db da mongo. Prima selezionare il db 
con il comando db e poi fare il drop. Vediamo con il comando show che il db mecbarfoto non è più presente 
nella lista dei database. 
</div>
<div class="mongobox">
    > use mecbarfoto<br>
switched to db mecbarfoto<br>
>  db.dropDatabase();<br>
{ "dropped" : "mecbarfoto", "ok" : 1 }<br>
> <br>

> show dbs <br> <br>
admin   0.000GB <br>
config  0.000GB <br>
local   0.000GB <br>
mecbar  0.000GB <br>
newdb   0.000GB <br>
</div>
   </div>
   <div class="testo">
    
    Mongo usa il formato JSON per la rappresentazione dei dati mentre usa il BSON (bynary json) 
    al suo interno per salvare i dati.

        
   </div>
    
   



      <div class="testo">
    Per effettuare le ricerche mongo ci fornisce i seguenti parametri che ora andremo ad esaminare.
    <br>Query di Ricerca:<br>
    $gt $lt $or $and $in $nin $type $exists $regex <br>
    Query di Update:<br>
    $set $unset $inc <br>
    Query di Update su Array:<br>
    $push $pop $pull $pushAll(deprecato) $pullAll <br>
    
      </div>
    

      <div class="testo">
<b>$gt e $lt </b>  non considerano gli estremi per inserirli nella ricerca inserire la e di equal $gte e $lte 
Il primo esempio eseguiamo una ricerca per l'attributo age > 25     
</div>
<div class="mongobox">
> db.users.find({ age: { $gt : 25 }  }).pretty()<br>
{<br>
	"_id" : ObjectId("5f3d4c7271fe14362210520d"),<br>
	"firstname" : "ugo",<br>
	"secondname" : "bianchi",<br>
	"city" : "turin",<br>
	"age" : 30<br>
}<br>
{<br>
	"_id" : ObjectId("5f3d4c9471fe14362210520e"),<br>
	"firstname" : "mario",<br>
	"secondname" : "verdi",<br>
	"city" : "venice",<br>
	"age" : 40<br>
}<br>
</div>
<div class="testo">
   <b>$gte </b>
</div>
<div class="mongobox">
> db.users.find({ age: { $gte : 25 }  }).pretty()<br>
{<br>
	"_id" : ObjectId("5f3d4c7271fe14362210520d"),<br>
	"firstname" : "ugo",<br>
	"secondname" : "bianchi",<br>
	"city" : "turin",<br>
	"age" : 30<br>
}<br>
{<br>
	"_id" : ObjectId("5f3d4c9471fe14362210520e"),<br>
	"firstname" : "mario",<br>
	"secondname" : "verdi",<br>
	"city" : "venice",<br>
	"age" : 40<br>
}<br>
{<br>
	"_id" : ObjectId("5f3d4cb471fe14362210520f"),<br>
	"firstname" : "maria",<br>
	"secondname" : "rossi",<br>
	"city" : "rome",<br>
	"age" : 25<br>
}<br>
<br>
</div>
<div class="testo">
<b>$gte e $lt </b>Maggiore uguale e minore di <br>
</div>

<div class="mongobox">
> db.users.find({ age: { $gte : 25, $lt : 30 }  }).pretty() <br>
{<br>
	"_id" : ObjectId("5f3d4cb471fe14362210520f"),<br>
	"firstname" : "maria",<br>
	"secondname" : "rossi",<br>
	"city" : "rome",<br>
	"age" : 25<br>
}<br><br>
</div>


<div class="testo">
Con le stringhe usa binary per cui ricerche non come attese <br>

<br>
<b>$exists</b>   per verificare se esiste componente <br>
</div>
<div class="mongobox">

> db.users.find({ city : { $exists : true } } )<br>
<br>{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "secondname" : "rossi", "city" : "rome" }
<br>{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "secondname" : "verdi", "city" : "milan" }
<br>{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "secondname" : "bianchi", "city" : "turin" }
<br>{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "secondname" : "bianchi", "city" : "turin", "age" : 30 }
<br>{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "secondname" : "verdi", "city" : "venice", "age" : 40 }
<br>{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "secondname" : "rossi", "city" : "rome", "age" : 25 }
</div>
<div class="testo">

 <b>{ $exists : false } </b> per estrarre tutti documenti che non hanno elemento indicato<br>
</div>
 <div class="mongobox">
> db.users.find({ age : { $exists : false } } )<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "secondname" : "rossi", "city" : "rome" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "secondname" : "verdi", "city" : "milan" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "secondname" : "bianchi", "city" : "turin" }<br>
 </div>

 <div class="testo">
<b>$type </b>  tipo di dato in bson vedere lista tipo in bsonspec.org   stringa = 2<br>
 </div>
<div class="mongobox">
db.users.find( { firstname: { $type : 2 } } )<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "secondname" : "rossi", "city" : "rome" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "secondname" : "verdi", "city" : "milan" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "secondname" : "bianchi", "city" : "turin" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "secondname" : "bianchi", "city" : "turin", "age" : 30 }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "secondname" : "verdi", "city" : "venice", "age" : 40 }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "secondname" : "rossi", "city" : "rome", "age" : 25 }<br>
<br><br>
</div>
<div class="testo">
<b>$regex</b> ricerca in base ad espressioni regolari quindi abbiamo tantissime combinazioni di ricerca <br>
Qui effettuiamo la ricerca di tutti i firstname con lettere 'iu' all'interno <br>
</div>
<div class="mongobox">
> db.users.find( { firstname: { $regex : "iu" } } )<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "secondname" : "bianchi", "city" : "turin" }<br>
</div>
<div class="testo">
<b>$regex con $</b> alla fine della stringa es. "a$" ricerca tutti i documenti che terminano con la stringa prima di $<br>
</div>
<div class="mongobox">
> db.users.find( { firstname: { $regex : "a$" } } )<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "secondname" : "rossi", "city" : "rome", "age" : 25 }<br>
</div>

<div class="testo">

<b>UPDATEMANY</b> usiamo questo parametro metodo di update per fare il rename 
di un elemento su tutta la collection con $rename <br>
</div>
<div class="mongobox">
db.users.updateMany( { }, { $rename: { 'secondname': 'lastname' } } )<br>
{ "acknowledged" : true, "matchedCount" : 6, "modifiedCount" : 6 }<br>
</div>
<div class="testo">
<b>$or</b> Procediamo con i parametri di ricerca  
</div>
<div class="mongobox">
> db.users.find( { $or : [ { lastname : { $regex : "o$"  } } , { age : { $exists : false } } ] })<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "city" : "rome", "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>
</div>

<div class="testo">
<b>$and</b> 
</div>
<div class="mongobox">
 > db.users.find( { $and : [ {firstname : { $regex : "o$"  } } , { age : { $exists : false } } ] })<br>
 { "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "city" : "rome", "lastname" : "rossi" }<br>
 { "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
</div>
<div class="testo">
 Il metodo sopra è uguale a quello sotto che viene privilegiato 
</div>
 <div class="mongobox">
 > db.users.find(  { firstname : "mario"  ,  age : { $exists : false }  })<br>
 { "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "city" : "rome", "lastname" : "rossi" }<br>
 { "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>

 </div>
 <div class="testo">
La ricerca si adegua al polimorfismo per cui le ricerche sugli array vengono fatte come le altre perchè mongo si accorge che si è in presenza di un array ed effettua la ricerca su tutto l'array però si ferma al primo livello e non effettua una ricerca nidificata per motivi di performance.
 
<br><br>

<b>$all</b>
 </div>
<div class="mongobox">
> db.users.find(  { job : { $all :[ "architect" , "politician"]  } } ).pretty()<br>
{<br>
	"_id" : ObjectId("5f3d5abd71fe143622105210"),<br>
	"firstname" : "luigi",<br>
	"lastname" : "verdi",<br>
	"job" : [<br>
		"architect",<br>
		"politician"<br>
	]<br>
}<br>
</div>
<div class="testo">
 
<b>$in</b> 
</div>
<div class="mongobox">
> db.users.find(  { firstname : { $in :[ "mario" , "maria"]  } } ) <br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "city" : "rome", "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 25, "lastname" : "rossi" }<br>
</div>
<div class="testo">
<b>$nin</b>   ovvero negazione di in <br>
</div>
<div class="mongobox">
> db.users.find(  { firstname : { $nin :[ "mario" , "maria"]  } } ) <br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
</div>
<div class="testo">
<b>Ricerca sotto-documenti</b> 
</div>
<div class="mongobox">
> db.users.find(  { "job" : "politician"   } )<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
</div>
<div class="testo">
   <b>next - limit - sort - skip </b>
Il risultato del find crea un oggetto cursore che ha 2 metodi :hasNext() e next()  <br>
Creiamo la variabile cursor ed applichiamo i 2 metodi
</div>
<div class="mongobox">
> var cursor = db.users.find( )  <br>
> cursor<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "city" : "rome", "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 25, "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
<br><br>


cursor.hasNext()   ritorna true se c'è un altro elemento su cui iterare <br>
<br>
cursor.hasNext()<br>
true<br>
<br><br>

cursor.next()  ritorna il valore della ricerca iterando sull'oggeto creato dalla ricerca <br>
<br>
> cursor.next()<br>
{<br>
	"_id" : ObjectId("5f3d4c1a71fe14362210520a"),<br>
	"firstname" : "mario",<br>
	"city" : "rome",<br>
	"lastname" : "rossi"<br>
}<br><br>

> cursor.next()<br>
{<br>
	"_id" : ObjectId("5f3d4c2b71fe14362210520b"),<br>
	"firstname" : "mario",<br>
	"city" : "milan",<br>
	"lastname" : "verdi"<br>
}<br>
</div>
<div class="testo">
<b>limit</b> per limitare i risultati della ricerca 
</div>
<div class="mongobox">
cursor.limit(2)   prendo solo i primi 2 risultati  <br>
> var cursor = db.users.find( ).limit(2)<br>
> cursor<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "firstname" : "mario", "city" : "rome", "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
<br><br>
> var cursor = db.users.find().limit(5).sort({firstname: 1 , lastname: -1})<br>
> cursor<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 25, "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
<br><br>
> var cursor = db.users.find().limit(5).sort({firstname: -1 , lastname: 1}).skip(4)<br>
> cursor<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 25, "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>

</div>

<div class="testo">
non è importante ordine perchè mongo usa un suo ordine e precisamente :<br>
prima sort poi limit ed infine skip <br>
  
<br><br>
<b>COUNT</b> ci indica il numero delle occorrenze in base ai parametri di ricerca inseriti
</div>
<div class="mongobox">
> db.users.count( { firstname: "mario" } )<br>
3<br>

</div>
<div class="testo">
<b>UPDATE</b>
<br><br>
1 metodo - prima ricerca e poi inserisce quanto inserito nel secondo oggetto - solo quello inserito se non riportato tutto 
il contenuto si perdono dati<br>
</div>
<div class="mongobox">

db.users.update({ firstname: "mario" }, { fistname:"mario", age:55 })  <br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br><br>
> db.users.find( )<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "fistname" : "mario", "age" : 55 }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 25, "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
</div>

<div class="testo">
2 metodo - con il $set modifichiamo il solo parametro inserito lasciando gli altri invariati <br>
</div>
<div class="mongobox">
> db.users.update({ firstname: "giuseppe" }, { $set :{  city:"florence" } })  <br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
<br>
> db.users.find( )<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "fistname" : "mario", "age" : 55 }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "florence", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 25, "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
</div>
<div class="testo">
cerca firstname poi modifica city ma se non lo trova inserisce il contenuto del secondo oggetto quindi posso inserire anche ulteriori dati <br>

<br><br>

<b>$inc</b> ci permette di incrementare valori numerici <br>
</div>
<div class="mongobox">
db.users.update({ name: "bob" }, { $inc:{  age: 1 } })    se age non c'è lo inserisce con il valore incrementale in questo caso 1 <br>
<br>
> db.users.update({ firstname: "maria" }, { $inc:{  age: 1 } }) <br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ firstname: "maria" })<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "city" : "rome", "age" : 26, "lastname" : "rossi" }<br><br>
</div>
<div class="testo">
<b>$unset</b> ci permette di eliminare un attributo :<br>
</div>
<div class="mongobox">
> db.users.update({ firstname: "maria" }, { $unset:{  city: true } })  <br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br><br>
> db.users.find({ firstname: "maria" })<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "age" : 26, "lastname" : "rossi" }<br><br>

</div>
<div class="testo">

<b>ARRAY</b> <br>

<br><br>
inserire un array in una collection <br>
</div>
<div class="mongobox">
> db.users.insert( {_id:0, a: [1,2,3,4,5]}) <br>
WriteResult({ "nInserted" : 1 })<br>
> db.users.find()<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "fistname" : "mario", "age" : 55 }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "firstname" : "mario", "city" : "milan", "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "florence", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "firstname" : "maria", "age" : 26, "lastname" : "rossi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
{ "_id" : 0, "a" : [ 1, 2, 3, 4, 5 ] }<br><br>
</div>
<div class="testo">
   Modificare un valore all'interno di un array - array a elemento alla quarta posizione 
</div>
<div class="mongobox">
db.users.update( {_id:0 } , {$set : { "a.4"  : 10 } })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
<br>

> db.users.find({ "_id" : 0 })<br><br>

{ "_id" : 0, "a" : [ 1, 2, 3, 4, 10 ] }<br>
</div>
<div class="testo">
<b>$push</b> aggiungere nuovo elemento in un array <br>
</div>
<div class="mongobox">
> db.users.update( {_id:0 } , {$push : { a  : 11 } })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 1, 2, 3, 4, 10, 11 ] }<br>

<br><br>
> db.users.update( {_id:0 } , {$push : { a :   [ 20,30, 40, 50 ]   } } )<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 2, 3, 4, [ 20, 30, 40, 50 ] ] }<br>
</div>

<div class="testo">

<b>$pull</b> eliminare da array elemento indipendente dalla posizione ma in base al valore<br>
</div>
 <div class="mongobox">
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 1, 2, 3, 4, 10, 11 ] }<br><br>
> db.users.update( {_id:0 } , {$pull: { "a"  : 10 } })<br>  
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 1, 2, 3, 4, 11 ] }<br>
 </div>
 <div class="testo">
<b>$pop</b> eliminare da array elemento in base a posizione - se mettiamo 1 elimina ultimo elemento se -1 elimina il primo <br>
 </div>
<div class="mongobox">
> db.users.update( {_id:0 } , {$pop : { a  : 1} }) <br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 1, 2, 3, 4 ] }<br>
<br>
> db.users.update( {_id:0 } , {$pop : { a  : -1} })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 2, 3, 4 ] }<br>
</div>
<div class="testo">
<b>$pullAll</b> elimina tutti elementi dall'array in base al valore indicato <br>
</div>

<div class="mongobox">
db.users.update( {_id:0 } , {$pullAll : { a: { [2,3 ]  } })<br>
<br>
> db.users.update( {_id:0 } , { $pullAll: { a:  [2,3 ]  } })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ] ] }<br>
</div>
<div class="testo">
<b>$addToSet</b> Insert dati in array solo se i dati indicati non sono presenti nell'array   <br>
</div>

<div class="mongobox">
db.users.update( {_id:0 } , {$addToSet : { a: { [20,30 40, 50]  } }) <br>
<br>
> db.users.update( {_id:0 } , {$addToSet: { a: 20  } }) <br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ], 20 ] }<br>
<br>
> db.users.update( {_id:0 } , { $addToSet: { a:[ 20,30]  } })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ], 20, [ 20, 30 ] ] }<br>
<br>

> db.users.update( {_id:0 } , { $addToSet: { a:[ 20,30]  } })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 0 })<br>
> db.users.find({ "_id" : 0 })<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ], 20, [ 20, 30 ] ] }<br>
</div>



<div class="testo">

<b>UPSET</b>  modifica e se non presente prima lo crea vuoto e poi lo modifica<br>
molto utile quando e come nella maggioranza dei casi se non si sa a priori se il docuemnto cercato esiste oppure no ...<br>
</div>

<div class="mongobox">
> db.users.update( { lastname:"bianchi" } , { $set : { city: "turin" } }, { upset: true })<br>
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })<br>
> db.users.find({ lastname : "bianchi" })<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "firstname" : "giuseppe", "city" : "turin", "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
</div>

<div class="testo">
<b>opzione multi </b> PER MODIFICARE PIU' DOCUMENTI  <br>
</div>
<div class="mongobox">
db.users.update( { country: {$exixts:true  } } , {$set: { country : "italy" } } , { multi:true })<br>
<br>
> db.users.update( { country: {$exists:true  } } , {$set: { country : "italy" } } , { multi:true })<br>
WriteResult({ "nMatched" : 0, "nUpserted" : 0, "nModified" : 0 })<br>
<br>
0 occurrenze<br>
<br>
> db.users.find()<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "fistname" : "mario", "age" : 55 }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "country" : "france" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "country" : "france" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "country" : "france" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ], 20, [ 20, 30 ] ] }<br>
<br>
> db.users.update( { country: {$exists:true  } } , {$set: { country : "italy" } } , { multi:true })<br>
WriteResult({ "nMatched" : 3, "nUpserted" : 0, "nModified" : 3 })<br>
> db.users.find()<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "fistname" : "mario", "age" : 55 }<br>
{ "_id" : ObjectId("5f3d4c2b71fe14362210520b"), "country" : "italy" }<br>
{ "_id" : ObjectId("5f3d4c4271fe14362210520c"), "country" : "italy" }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d4cb471fe14362210520f"), "country" : "italy" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ], 20, [ 20, 30 ] ] }<br>
</div>

<div class="testo">
ELIMINARE DOCUMENTI : <br><br>
<b>remove</b>   con il comando remove si elimina un documento alla volta per se tanti è lento <br>
</div>
<div class="mongobox">
> db.users.remove( { country: "italy"  } ) <br>
WriteResult({ "nRemoved" : 3 })<br><br>
> db.users.find()<br>
{ "_id" : ObjectId("5f3d4c1a71fe14362210520a"), "fistname" : "mario", "age" : 55 }<br>
{ "_id" : ObjectId("5f3d4c7271fe14362210520d"), "firstname" : "ugo", "city" : "turin", "age" : 30, "lastname" : "bianchi" }<br>
{ "_id" : ObjectId("5f3d4c9471fe14362210520e"), "firstname" : "mario", "city" : "venice", "age" : 40, "lastname" : "verdi" }<br>
{ "_id" : ObjectId("5f3d5abd71fe143622105210"), "firstname" : "luigi", "lastname" : "verdi", "job" : [ "architect", "politician" ] }<br>
{ "_id" : 0, "a" : [ 4, [ 20, 30, 40, 50 ], 20, [ 20, 30 ] ] }<br>
</div>
<div class="testo">
<b>drop</b> elimina tutti i documenti della collection senza condizioni - molto veloce ma non si può scegliere cosa eliminare<br>
</div>
<div class="mongobox">
> db.users.drop()<br>
true<br>
> db.users.find()<br>
</div>






</body>
</html>